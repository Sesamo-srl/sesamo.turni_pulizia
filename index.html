<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Chi pulisce?</title>

    <!-- Google Font: Manrope -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400..800&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --bg: #0f0f12;
        --muted: #9aa0a6;
        --txt: #f5f5f7;
        --accent: #ff7a00; /* arancione principale */
        --accent-2: #ffc14d; /* arancione chiaro */
        --radius: 18px;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: "Manrope", system-ui, -apple-system, Segoe UI, Roboto,
          Inter, Arial, sans-serif;
        color: var(--txt);
        background: linear-gradient(180deg, #111217, #0c0c10 60%);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100dvh;
        padding: 24px;
      }
      .wrap {
        inline-size: min(720px, 100%);
        display: flex;
        flex-direction: column;
        gap: 16px;
        align-items: center;
        text-align: center;
      }
      .logo {
        width: 48px;
        height: 48px;
        margin-bottom: 12px;
      }
      h1 {
        margin: 0;
        font-size: clamp(1.4rem, 4.5vw, 2rem);
        letter-spacing: 0.2px;
        font-weight: 800;
        font-family: "Manrope", system-ui, -apple-system, Segoe UI, Roboto,
          Inter, Arial, sans-serif;
      }
      .cta-card {
        border-radius: var(--radius);
        padding: 20px;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .btn {
        width: 100%;
        max-width: 560px;
        padding: 100px 20px;
        border-radius: calc(var(--radius) + 6px);
        border: none;
        font-weight: 900;
        letter-spacing: 0.6px;
        text-transform: uppercase;
        font-family: "Manrope", system-ui, -apple-system, Segoe UI, Roboto,
          Inter, Arial, sans-serif;

        background: linear-gradient(90deg, var(--accent), var(--accent-2));
        color: #0b0b10;
        cursor: pointer;
        transition: transform 0.06s ease, filter 0.15s ease, opacity 0.2s ease;
        font-size: clamp(1.25rem, 3.8vw, 2rem);
      }
      .btn:active {
        transform: translateY(1px) scale(0.998);
      }
      .btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }
      .btn:focus-visible {
        outline: none;
        box-shadow: 0 0 0 4px rgba(255, 122, 0, 0.35);
      }
      .result {
        background: linear-gradient(180deg, #15151c, #121219);
        border: 1px dashed rgba(255, 255, 255, 0.12);
        border-radius: var(--radius);
        padding: 16px;
        min-height: 56px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        font-size: 1.05rem;
        color: var(--muted);
        width: 75%;
      }
      .result strong {
        font-size: 1.4rem;
        color: var(--txt);
      }

      /* Overlay fullscreen con blur */
      .overlay {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 24px;
        background: rgba(0, 0, 0, 0.35);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        z-index: 999;
      }
      .overlay.show {
        display: flex;
      }
      .overlay .winner {
        font-weight: 900;
        line-height: 1.1;
        letter-spacing: 0.6px;
        text-transform: uppercase;
        font-size: clamp(2.4rem, 9vw, 6rem);
        color: #fff4e5;
        text-shadow: 0 4px 20px rgba(0, 0, 0, 0.45);
        animation: pop 0.45s ease-out both;
      }
      .overlay .subtitle {
        margin-top: 10px;
        color: #ffd7a3;
        font-size: clamp(0.95rem, 2.8vw, 1.3rem);
        opacity: 0.9;
      }
      .overlay .close-hint {
        margin-top: 16px;
        font-size: 0.9rem;
        color: #cbb6a0;
        opacity: 0.8;
      }
      @keyframes pop {
        0% {
          transform: scale(0.9);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <main class="wrap">
      <img
        src="https://storage.googleapis.com/sesamo_website_assets/mail-signature/noce3d.png"
        alt="Logo"
        class="logo"
      />
      <h1>Chi pulisce oggi?</h1>

      <section class="cta-card">
        <button class="btn" id="drawBtn" aria-busy="false">
          DIMMI CHI PULISCE
        </button>
      </section>

      <section class="result" id="result" aria-live="polite">
        Tieniti pronto se tocca a te! âœ¨
      </section>
    </main>

    <!-- Overlay fullscreen -->
    <div
      class="overlay"
      id="overlay"
      role="dialog"
      aria-modal="true"
      aria-label="Risultato estrazione"
    >
      <div>
        <div class="winner" id="winnerName">Marco</div>
        <div class="subtitle">oggi tocca a te! ðŸ§¹</div>
      </div>
    </div>

    <script>
      const NAMES = [
        "Androcolo",
        "Andromario",
        "Dario",
        "Giulio",
        "Lollone",
        "Lucrazy",
        "Marco",
      ];

      const drawBtn = document.getElementById("drawBtn");
      const result = document.getElementById("result");
      const overlay = document.getElementById("overlay");
      const winnerNameEl = document.getElementById("winnerName");

      let isDrawing = false;
      let lastWinner = null; // esclude l'ultimo

      function draw() {
        if (isDrawing) return;
        isDrawing = true;
        drawBtn.disabled = true;
        drawBtn.setAttribute("aria-busy", "true");

        let picked;
        do {
          const index = Math.floor(Math.random() * NAMES.length);
          picked = NAMES[index];
        } while (picked === lastWinner && NAMES.length > 1);

        lastWinner = picked;

        result.innerHTML = `Oggi pulisce:&nbsp<strong>${picked}</strong>&nbspðŸ§¹`;
        showOverlay(picked);
        confettiBurst();
      }

      function showOverlay(name) {
        winnerNameEl.textContent = name;
        overlay.classList.add("show");

        const close = () => {
          overlay.classList.remove("show");
          overlay.removeEventListener("click", close);
          document.removeEventListener("keydown", onKey);
          isDrawing = false;
          drawBtn.disabled = false;
          drawBtn.setAttribute("aria-busy", "false");
        };
        const onKey = (e) => {
          if (e.key === "Escape" || e.key === "Esc") close();
        };

        overlay.addEventListener("click", close);
        document.addEventListener("keydown", onKey);
      }

      function confettiBurst() {
        const canvas = document.createElement("canvas");
        canvas.style.position = "fixed";
        canvas.style.inset = "0";
        canvas.style.pointerEvents = "none";
        canvas.style.zIndex = "1000";
        document.body.appendChild(canvas);

        const ctx = canvas.getContext("2d");
        let w, h, particles, last;
        const TAU = Math.PI * 2;

        const colors = ["#ff7a00", "#ffc14d", "#ffffff", "#ffd591", "#ff9f40"];

        function resize() {
          w = canvas.width = window.innerWidth;
          h = canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener("resize", resize, { once: true });

        const count = Math.min(180, Math.floor((w * h) / 9000));
        particles = [...Array(count)].map(() => {
          const angle = Math.random() * TAU;
          const speed = 6 + Math.random() * 6;
          const vx = Math.cos(angle) * speed;
          const vy = Math.sin(angle) * speed - 4;
          return {
            x: w / 2,
            y: h * 0.3,
            vx,
            vy,
            g: 0.18 + Math.random() * 0.15,
            size: 3 + Math.random() * 5,
            rot: Math.random() * TAU,
            vr: (Math.random() - 0.5) * 0.2,
            life: 1100 + Math.random() * 800,
            color: colors[(Math.random() * colors.length) | 0],
            shape: Math.random() < 0.6 ? "rect" : "circle",
          };
        });

        last = performance.now();
        function frame(now) {
          const dt = now - last;
          last = now;
          ctx.clearRect(0, 0, w, h);

          let alive = 0;
          for (const p of particles) {
            p.vy += p.g;
            p.x += p.vx;
            p.y += p.vy;
            p.rot += p.vr;
            p.life -= dt;

            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate(p.rot);
            ctx.fillStyle = p.color;
            if (p.shape === "rect") {
              ctx.fillRect(-p.size, -p.size / 2, p.size * 2, p.size);
            } else {
              ctx.beginPath();
              ctx.arc(0, 0, p.size, 0, TAU);
              ctx.fill();
            }
            ctx.restore();

            if (p.life > 0 && p.y < h + 40) alive++;
          }

          if (alive > 0) {
            requestAnimationFrame(frame);
          } else {
            canvas.remove();
          }
        }
        requestAnimationFrame(frame);
      }

      drawBtn.addEventListener("click", draw);
    </script>
  </body>
</html>
